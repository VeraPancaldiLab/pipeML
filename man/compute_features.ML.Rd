% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/machine_learning.R
\name{compute_features.ML}
\alias{compute_features.ML}
\title{Train and evaluate machine learning models with optional stacking and feature selection}
\usage{
compute_features.ML(
  features_train,
  features_test,
  clinical,
  trait,
  trait.positive,
  metric = "Accuracy",
  stack,
  k_folds = 10,
  n_rep = 5,
  feature.selection = FALSE,
  seed,
  LODO = FALSE,
  n_boruta = 100,
  boruta_fix = FALSE,
  batch_id = NULL,
  file_name = NULL,
  ncores = NULL,
  maximize = "Accuracy",
  return = FALSE
)
}
\arguments{
\item{features_train}{A data frame of features used for training the models.}

\item{features_test}{A data frame of features used for testing the models.}

\item{clinical}{A data frame containing clinical information, including the target variable and optionally a batch ID. Row names must match the sample identifiers in \code{features_train} and \code{features_test}.}

\item{trait}{Character. The name of the column in \code{clinical} corresponding to the target variable.}

\item{trait.positive}{Value in \code{trait} to be considered as the positive class.}

\item{metric}{Character. Metric used for hyperparameter tuning and model selection. Supported values are \code{"Accuracy"}, \code{"AUROC"}, and \code{"AUPRC"}.}

\item{stack}{Logical. Whether to apply model stacking. Default is \code{FALSE}.}

\item{k_folds}{Integer. Number of folds for cross-validation.}

\item{n_rep}{Integer. Number of cross-validation repetitions.}

\item{feature.selection}{Logical. Whether to apply Boruta feature selection before training. Default is \code{FALSE}.}

\item{seed}{Integer. Random seed for reproducibility.}

\item{LODO}{Logical. If \code{TRUE}, folds are constructed in a Leave-One-Dataset-Out (LODO) manner based on cohorts.}

\item{n_boruta}{Integer. Number of iterations to run Boruta. Since Boruta involves randomness, repeated runs improve consistency. Default is 100.}

\item{boruta_fix}{Logical. Whether to fix Borutaâ€™s internal parameters. See \code{compute_boruta()} for details.}

\item{batch_id}{A vector indicating the cohort/batch for each sample (only required if \code{LODO = TRUE}).}

\item{file_name}{Character. Base name used to save plots in the \code{Results/} directory.}

\item{ncores}{Integer. Number of cores to use for parallelization. If not given, detectCores() - 1 will be used.}

\item{maximize}{A character string indicating which metric to maximize when selecting the best
threshold for the confusion matrix. Options include "Accuracy", "Precision",
"Recall", "Specificity", "Sensitivity", "F1", or "MCC". Default is "Accuracy".}

\item{return}{Logical. Whether to return and save plots generated by the function.}
}
\value{
A list containing:
\itemize{
\item Trained model (or meta-learner if stacking was used)
\item Features used in model training
\item Prediction performance metrics
\item AUC scores (AUROC and AUPRC)
\item Predicted class probabilities on test data
}
}
\description{
This function trains machine learning models using cross-validation on training data and evaluates them on test data. It supports feature selection with Boruta, model stacking, and cohort-based (LODO) validation.
}
